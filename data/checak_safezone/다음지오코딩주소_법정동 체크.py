from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from data.checak_safezone.safezone_db import *
from data.check_building_info.AD_converter import find_cd
from pprint import pprint
import progressbar
"""
다음 API를 이용하여 받은 주소를 바탕으로 법정동 코드를 분리하는 테스트 코드입니다.
테스트 결과는 아래와 같습니다.
=============================================================
100% (6118 of 6118) |#####################| Elapsed Time: 0:05:48 Time: 0:05:48
총 6118개의 주소에서 5558개가 성공적으로 변환됬으며 560개는 실패함
법정코드 변환 실패한 주소입니다.
===============================
['경상북도 거창군 고제면 궁항리 1862',
 '경상북도 거창군 웅양면 노현리 292',
 '경상북도 거창군 북상면 갈계리 1439-1',
 '경상북도 거창군 주상면 도평리 536',
 '경상북도 합천군 가야면 사촌리 166',
 '경상북도 합천군 가야면 황산리 180-1',
 '경상북도 합천군 가야면 황산리 16-1',
 '경상북도 거창군 거창읍 중앙리 306-8',
 '경상북도 거창군 거창읍 상림리 820',
 '경상북도 거창군 거창읍 양평리 1160',
 '경상북도 거창군 마리면 말흘리 274',
 '경상북도 거창군 가조면 마상리 336-4',
 '경상북도 거창군 남하면 무릉리 1290',
 '경상북도 합천군 묘산면 산제리 316-1',
 '경상북도 함양군 서상면 도천리 1047-6',
 '경상북도 창녕군 성산면 정녕리 28',
 '경상북도 합천군 봉산면 김봉리 348-6',
 '경상북도 함양군 안의면 석천리 121-1',
 '경상북도 합천군 덕곡면 장리 761',
 '경상북도 함양군 안의면 석천리 73',
 '경상북도 함양군 안의면 당본리 203',
 '경상북도 함양군 안의면 석천리 84',
 '경상북도 밀양시 산내면 송백리 2081-1',
 '경상북도 밀양시 산내면 남명리 1113-2',
 '경상북도 창녕군 이방면 장천리 436',
 '경상북도 창녕군 이방면 장천리 49',
 '경상북도 창녕군 대합면 십이리 456',
 '경상북도 합천군 율곡면 영전리 446',
 '경상북도 합천군 쌍책면 성산리 50',
 '경상북도 합천군 쌍책면 성산리 639-1',
 '경상북도 창녕군 고암면 중대리 284',
 '경상북도 창녕군 이방면 안리 828',
 '경상북도 합천군 합천읍 합천리 937',
 '경상북도 합천군 합천읍 합천리 840-2',
 '경상북도 합천군 합천읍 합천리 315',
 '경상북도 합천군 합천읍 합천리 292-3',
 '경상북도 합천군 합천읍 합천리 315',
 '경상북도 거창군 신원면 과정리 199-4',
 '경상북도 창녕군 대지면 석리 277',
 '경상북도 합천군 청덕면 두곡리 428',
 '경상북도 합천군 초계면 아막리 99',
 '경상북도 합천군 초계면 초계리 87-2',
 '경상북도 합천군 합천읍 합천리 943-1',
 '경상북도 밀양시 청도면 두곡리 60-1',
 '경상북도 밀양시 상동면 금산리 887-3',
 '경상북도 밀양시 상동면 금산리 876-3',
 '경상북도 창녕군 창녕읍 교상리 28-33',
 '경상북도 창녕군 창녕읍 교리 254',
 '경상북도 밀양시 청도면 인산리 667-1',
 '경상북도 합천군 적중면 상부리 142-1',
 '경상북도 함양군 병곡면 도천리 산 80',
 '경상북도 함양군 수동면 화산리 1097',
 '경상북도 함양군 함양읍 교산리 201',
 '경상북도 함양군 수동면 화산리 1010',
 '경상북도 함양군 함양읍 교산리 956',
 '경상북도 함양군 함양읍 교산리 210',
 '경상북도 밀양시 단장면 범도리 1535-1',
 '경상북도 밀양시 교동 1111',
 '경상북도 창녕군 유어면 부곡리 481',
 '경상북도 밀양시 교동 448',
 '경상북도 밀양시 단장면 단장리 808',
 '경상북도 함양군 함양읍 백연리 253',
 '경상북도 밀양시 단장면 태룡리 419-2',
 '경상북도 밀양시 부북면 운전리 323-1',
 '경상북도 합천군 대양면 덕정리 898-4',
 '경상북도 창녕군 창녕읍 퇴천리 산 62',
 '경상북도 합천군 대병면 회양리 880',
 '경상북도 함양군 함양읍 백연리 596-1',
 '경상북도 함양군 함양읍 백연리 산 2-11',
 '경상북도 함양군 함양읍 운림리 27-1',
 '경상북도 양산시 하북면 순지리 125-5',
 '경상북도 밀양시 내이동 1025',
 '경상북도 밀양시 내일동 271',
 '경상북도 산청군 생초면 어서리 351',
 '경상북도 밀양시 내일동 326',
 '경상북도 산청군 오부면 오전리 840',
 '경상북도 밀양시 내이동 602-7',
 '경상북도 밀양시 내이동 590-4',
 '경상북도 밀양시 내이동 602-4',
 '경상북도 밀양시 내이동 590-1',
 '경상북도 밀양시 내이동 602-4',
 '경상북도 밀양시 교동 843',
 '경상북도 밀양시 산외면 금천리 608-5',
 '경상북도 함양군 유림면 화촌리 472',
 '경상북도 밀양시 무안면 무안리 927-1',
 '경상북도 밀양시 가곡동 566-1',
 '경상북도 밀양시 가곡동 728-4',
 '경상북도 함양군 휴천면 금반리 92',
 '경상북도 밀양시 무안면 신법리 327-1',
 '경상북도 밀양시 삼문동 586-1',
 '경상북도 밀양시 무안면 신법리 192',
 '경상북도 밀양시 무안면 신법리 192',
 '경상북도 의령군 낙서면 정곡리 167-2',
 '경상북도 의령군 낙서면 전화리 206',
 '경상북도 밀양시 삼문동 141-14',
 '경상북도 의령군 낙서면 전화리 228-2',
 '경상북도 창녕군 계성면 계성리 194',
 '경상북도 밀양시 삼문동 4-19',
 '경상북도 밀양시 삼문동 3-5',
 '경상북도 밀양시 삼문동 323-1',
 '경상북도 양산시 하북면 순지리 702',
 '경상북도 합천군 쌍백면 평구리 531-3',
 '경상북도 양산시 상북면 좌삼리 493',
 '경상북도 의령군 궁류면 토곡리 482-2',
 '경상북도 양산시 하북면 백록리 1245-1',
 '경상북도 밀양시 삼랑진읍 숭진리 600',
 '경상북도 창녕군 영산면 성내리 591-4',
 '경상북도 창녕군 장마면 강리 766-1',
 '경상북도 의령군 부림면 신반리 148-6',
 '경상북도 산청군 차황면 장위리 22',
 '경상북도 의령군 부림면 신반리 253-1',
 '경상북도 밀양시 상남면 예림리 936',
 '경상북도 의령군 유곡면 칠곡리 541',
 '경상북도 창녕군 도천면 도천리 276',
 '경상북도 합천군 가회면 덕촌리 389',
 '경상북도 의령군 궁류면 압곡리 348-2',
 '경상북도 창녕군 부곡면 부곡리 115',
 '경상북도 의령군 궁류면 평촌리 산 61-3',
 '경상북도 양산시 삼호동 623',
 '경상북도 산청군 금서면 매촌리 1',
 '경상북도 양산시 삼호동 886-2',
 '경상북도 밀양시 초동면 성만리 628-1',
 '경상북도 밀양시 상남면 평촌리 180-3',
 '경상북도 산청군 산청읍 옥산리 747',
 '경상북도 밀양시 초동면 신호리 16-2',
 '경상북도 합천군 삼가면 소오리 393-3',
 '경상북도 합천군 삼가면 일부리 398',
 '경상북도 양산시 상북면 석계리 51',
 '경상북도 양산시 상북면 석계리 122',
 '경상북도 함안군 칠서면 용성리 22-22',
 '경상북도 함양군 마천면 덕전리 866-2',
 '경상북도 창녕군 남지읍 남지리 723',
 '경상북도 양산시 평산동 570-40',
 '경상북도 창녕군 남지읍 남지리 598-2',
 '경상북도 밀양시 상남면 동산리 713-3',
 '경상북도 밀양시 하남읍 대사리 558-1',
 '경상북도 밀양시 삼랑진읍 송지리 413-1',
 '경상북도 양산시 어곡동 1427-1',
 '경상북도 밀양시 삼랑진읍 송지리 162-2',
 '경상북도 밀양시 삼랑진읍 송지리 182-1',
 '경상북도 양산시 소주동 669',
 '경상북도 양산시 덕계동 718-4',
 '경상북도 양산시 원동면 원리 577',
 '경상북도 양산시 평산동 281-1',
 '경상북도 밀양시 하남읍 수산리 468-1',
 '경상북도 양산시 평산동 297-3',
 '경상북도 의령군 정곡면 성황리 793',
 '경상북도 양산시 평산동 290',
 '경상북도 산청군 신등면 단계리 663',
 '경상북도 의령군 정곡면 중교리 428-1',
 '경상북도 양산시 상북면 소토리 651',
 '경상북도 양산시 평산동 350',
 '경상북도 의령군 지정면 봉곡리 511-1',
 '경상북도 의령군 정곡면 중교리 산 3-1',
 '경상북도 양산시 평산동 40-3',
 '경상북도 함양군 마천면 덕전리 88-1',
 '경상북도 함안군 칠서면 이룡리 900',
 '경상북도 산청군 신등면 양전리 43-2',
 '경상북도 함안군 대산면 구혜리 163',
 '경상북도 함안군 칠북면 화천리 792',
 '경상북도 양산시 북정동 555',
 '경상북도 양산시 원동면 원리 951',
 '경상북도 양산시 북정동 382-2',
 '경상북도 함안군 칠북면 이령리 231-3',
 '경상북도 창원시 의창구 대산면 갈전리 676-1',
 '경상북도 창원시 의창구 대산면 일동리 170',
 '경상북도 밀양시 하남읍 백산리 697-1',
 '경상북도 창원시 의창구 북면 하천리 944',
 '경상북도 의령군 대의면 마쌍리 439-1',
 '경상북도 밀양시 하남읍 수산리 883-56',
 '경상북도 양산시 어곡동 150',
 '경상북도 양산시 교동 206',
 '경상북도 양산시 북부동 269',
 '경상북도 양산시 북부동 533',
 '경상북도 산청군 생비량면 도리 595-1',
 '경상북도 함안군 대산면 평림리 955',
 '경상북도 함안군 칠북면 검단리 980',
 '경상북도 의령군 용덕면 운곡리 234-2',
 '경상북도 양산시 북부동 255',
 '경상북도 창원시 의창구 북면 신촌리 612-2',
 '경상북도 양산시 북부동 234',
 '경상북도 양산시 원동면 화제리 1296-2',
 '경상북도 함안군 대산면 구혜리 229',
 '경상북도 양산시 신기동 511-1',
 '경상북도 김해시 생림면 생철리 316-2',
 '경상북도 의령군 정곡면 백곡리 1162',
 '경상북도 양산시 남부동 556-2',
 '경상북도 의령군 가례면 수성리 199-2',
 '경상북도 창원시 의창구 대산면 제동리 280',
 '경상북도 양산시 물금읍 범어리 503',
 '경상북도 산청군 삼장면 석남리 188',
 '경상북도 산청군 신안면 문대리 589-3',
 '경상북도 양산시 중부동 696-2',
 '경상북도 창원시 의창구 대산면 가술리 150',
 '경상북도 의령군 용덕면 가락리 189-5',
 '경상북도 의령군 칠곡면 외조리 85-1',
 '경상북도 양산시 중부동 422-3',
 '경상북도 양산시 교동 273',
 '경상북도 양산시 교동 273',
 '경상북도 함안군 법수면 강주리 408-2',
 '경상북도 의령군 의령읍 동동리 1012',
 '경상북도 의령군 가례면 가례리 265-1',
 '경상북도 의령군 의령읍 동동리 1087',
 '경상북도 양산시 동면 여락리 산 18',
 '경상북도 김해시 한림면 장방리 146-1',
 '경상북도 의령군 가례면 대천리 54',
 '경상북도 양산시 물금읍 범어리 554',
 '경상북도 양산시 물금읍 범어리 718-3',
 '경상북도 양산시 남부동 601-3',
 '경상북도 함안군 칠서면 청계리 729',
 '경상북도 양산시 남부동 556-1',
 '경상북도 함안군 법수면 우거리 912',
 '경상북도 양산시 동면 사송리 874-1',
 '경상북도 함안군 법수면 우거리 922-1',
 '경상북도 의령군 의령읍 동동리 821',
 '경상북도 의령군 의령읍 서동리 543',
 '경상북도 함안군 칠서면 무릉리 908',
 '경상북도 함안군 법수면 윤외리 200',
 '경상북도 창원시 의창구 북면 동전리 141-3',
 '경상북도 진주시 미천면 안간리 797-5',
 '경상북도 의령군 의령읍 동동리 1002',
 '경상북도 의령군 의령읍 중동리 246',
 '경상북도 산청군 단성면 성내리 596-2',
 '경상북도 함안군 칠원읍 유원리 374',
 '경상북도 함안군 가야읍 산서리 684-23',
 '경상북도 산청군 신안면 하정리 721',
 '경상북도 창원시 의창구 북면 대산리 56-2',
 '경상북도 함안군 칠원읍 구성리 980',
 '경상북도 양산시 물금읍 물금리 95',
 '경상북도 김해시 상동면 대감리 656-2',
 '경상북도 함안군 칠원읍 용산리 321-1',
 '경상북도 창원시 의창구 동읍 신방리 664',
 '경상북도 산청군 단성면 입석리 1154-2',
 '경상북도 함안군 산인면 내인리 204',
 '경상북도 진주시 미천면 오방리 180-1',
 '경상북도 함안군 군북면 월촌리 1214',
 '경상북도 함안군 가야읍 도항리 463',
 '경상북도 함안군 가야읍 도항리 463',
 '경상북도 함안군 칠원읍 오곡리 101',
 '경상북도 함안군 칠원읍 오곡리 97',
 '경상북도 의령군 화정면 상정리 601-2',
 '경상북도 의령군 화정면 상정리 642-1',
 '경상북도 함안군 칠원읍 예곡리 433',
 '경상북도 창원시 의창구 동읍 용잠리 282',
 '경상북도 창원시 의창구 동읍 봉산리 401-4',
 '경상북도 함안군 가야읍 도항리 88-1',
 '경상북도 산청군 시천면 동당리 75-4',
 '경상북도 김해시 삼계동 산 4-1',
 '경상북도 함안군 군북면 덕대리 267',
 '경상북도 김해시 삼계동 1437',
 '경상북도 함안군 산인면 입곡리 1121',
 '경상북도 함안군 산인면 입곡리 산 135-1',
 '경상북도 창원시 마산회원구 내서읍 호계리 503',
 '경상북도 함안군 산인면 입곡리 1193',
 '경상북도 함안군 군북면 소포리 1591-64',
 '경상북도 함안군 가야읍 말산리 257-1',
 '경상북도 함안군 산인면 모곡리 510',
 '경상북도 창원시 의창구 팔용동 75',
 '경상북도 창원시 마산회원구 구암동 산 92',
 '경상북도 창원시 의창구 봉림동 산 120',
 '경상북도 김해시 구산동 660',
 '경상북도 창원시 마산회원구 구암동 1346',
 '경상북도 김해시 삼방동 730',
 '경상북도 창원시 마산회원구 구암동 1333',
 '경상북도 함안군 군북면 덕대리 17',
 '경상북도 창원시 의창구 도계동 357-1',
 '경상북도 창원시 마산회원구 합성동 17-4',
 '경상북도 창원시 성산구 반지동 34',
 '경상북도 창원시 의창구 봉곡동 46-1',
 '경상북도 김해시 삼방동 201',
 '경상북도 김해시 내동 106-1',
 '경상북도 창원시 마산회원구 구암동 44-5',
 '경상북도 창원시 의창구 봉곡동 107-7',
 '경상북도 진주시 집현면 덕오리 725-2',
 '경상북도 창원시 마산회원구 구암동 9-2',
 '경상북도 김해시 진례면 초전리 242-1',
 '경상북도 창원시 의창구 명서동 38-2',
 '경상북도 김해시 서상동 172',
 '경상북도 김해시 대동면 주동리 399-1',
 '경상북도 창원시 성산구 반림동 7',
 '경상북도 창원시 마산회원구 내서읍 삼계리 3-12',
 '경상북도 김해시 대성동 140',
 '경상북도 함안군 함안면 봉성리 1238-3',
 '경상북도 함안군 함안면 북촌리 1004',
 '경상북도 함안군 함안면 북촌리 1002-3',
 '경상북도 창원시 마산회원구 합성동 167-10',
 '경상북도 진주시 집현면 지내리 125',
 '경상북도 창원시 성산구 반지동 99',
 '경상북도 창원시 의창구 대원동 109',
 '경상북도 창원시 성산구 토월동 709',
 '경상북도 창원시 마산회원구 석전동 203-7',
 '경상북도 창원시 마산회원구 회성동 458-9',
 '경상북도 김해시 지내동 297-5',
 '경상북도 김해시 부원동 39',
 '경상북도 진주시 지수면 압사리 1065-1',
 '경상북도 창원시 마산회원구 양덕동 42',
 '경상북도 창원시 의창구 대원동 43',
 '경상북도 창원시 의창구 용호동 68-1',
 '경상북도 창원시 의창구 두대동 145',
 '경상북도 진주시 대평면 대평리 509',
 '경상북도 김해시 동상동 534',
 '경상북도 창원시 성산구 반림동 6-4',
 '경상북도 창원시 성산구 사파동 110',
 '경상북도 창원시 마산회원구 회원동 376-1',
 '경상북도 창원시 성산구 상남동 44-2',
 '경상북도 창원시 마산회원구 양덕동 477',
 '경상북도 창원시 성산구 사파정동 305',
 '경상북도 창원시 마산회원구 양덕동 165-6',
 '경상북도 창원시 의창구 신월동 76',
 '경상북도 창원시 성산구 중앙동 114',
 '경상북도 창원시 의창구 용호동 1',
 '경상북도 창원시 성산구 중앙동 22',
 '경상북도 하동군 청암면 묵계리 550',
 '경상북도 창원시 마산합포구 교방동 376-8',
 '경상북도 창원시 마산합포구 산호동 532-12',
 '경상북도 창원시 성산구 상남동 46',
 '경상북도 창원시 성산구 가음정동 산 11',
 '경상북도 창원시 성산구 상남동 62',
 '경상북도 창원시 성산구 상남동 89-1',
 '경상북도 창원시 성산구 대방동 259',
 '경상북도 창원시 성산구 중앙동 103',
 '경상북도 진주시 장재동 582',
 '경상북도 창원시 성산구 상남동 44-3',
 '경상북도 창원시 마산회원구 회원동 393-1',
 '경상북도 창원시 마산합포구 산호동 53-1',
 '경상북도 진주시 상봉동 1445',
 '경상북도 창원시 성산구 가음동 25',
 '경상북도 창원시 성산구 가음동 30',
 '경상북도 김해시 부곡동 800-4',
 '경상북도 창원시 성산구 가음동 22-6',
 '경상북도 창원시 마산합포구 성호동 57-3',
 '경상북도 함안군 여항면 외암리 726-1',
 '경상북도 창원시 마산합포구 산호동 452-5',
 '경상북도 창원시 성산구 남양동 18',
 '경상북도 창원시 마산합포구 산호동 438-1',
 '경상북도 창원시 성산구 가음정동 26',
 '경상북도 창원시 성산구 가음정동 산 31',
 '경상북도 창원시 성산구 가음정동 산 31',
 '경상북도 창원시 성산구 신촌동 32',
 '경상북도 김해시 삼문동 60-1',
 '경상북도 진주시 유곡동 180-2',
 '경상북도 진주시 상봉동 987-3',
 '경상북도 하동군 화개면 삼신리 594-2',
 '경상북도 진주시 봉래동 27-2',
 '경상북도 진주시 상봉동 777',
 '경상북도 진주시 상봉동 856-1',
 '낙월면 상낙월리 산361',
 '경상북도 창원시 성산구 신촌동 36-3',
 '경상북도 창원시 성산구 성주동 528-2',
 '경상북도 창원시 마산합포구 자산동 119-9',
 '경상북도 창원시 마산합포구 장군동1가 16-1',
 '경상북도 진주시 이현동 25-1',
 '경상북도 진주시 인사동 1-25',
 '경상북도 진주시 중안동 14-9',
 '경상북도 진주시 수곡면 대천리 산 98',
 '경상북도 진주시 옥봉동 700-1',
 '경상북도 진주시 봉곡동 465-1',
 '경상북도 진주시 이현동 1178',
 '경상북도 창원시 마산합포구 월영동 산 175-8',
 '경상북도 진주시 신안동 380',
 '경상북도 진주시 칠암동 237-2',
 '경상북도 창원시 성산구 안민동 189-2',
 '경상북도 진주시 하대동 119-1',
 '경상북도 하동군 청암면 상이리 71-5',
 '경상북도 진주시 수곡면 창촌리 산 72-1',
 '경상북도 진주시 신안동 1-1',
 '경상북도 진주시 신안동 1-1',
 '경상북도 진주시 신안동 1-1',
 '경상북도 진주시 신안동 1-1',
 '경상북도 창원시 마산합포구 월영동 534-30',
 '부산광역시 부산광역시진구 초읍동 541-1',
 '경상북도 진주시 망경동 490',
 '부산광역시 부산광역시진구 초읍동 540',
 '경상북도 진주시 망경동 163-5',
 '경상북도 진주시 상대동 645-9',
 '경상북도 김해시 율하동 1407',
 '경상북도 김해시 관동동 460-1',
 '부산광역시 부산광역시진구 부암동 719',
 '경상북도 창원시 마산합포구 해운동 54',
 '경상북도 창원시 마산합포구 월영동 605-1',
 '부산광역시 부산광역시진구 양정동 455-7',
 '부산광역시 부산광역시진구 초읍동 117-1',
 '경상북도 진주시 상평동 272-1',
 '경상북도 하동군 옥종면 양구리 41-1',
 '경상북도 진주시 상평동 218-1',
 '경상북도 하동군 옥종면 청룡리 227',
 '경상북도 진주시 문산읍 삼곡리 640-1',
 '부산광역시 부산광역시진구 당감동 897',
 '경상북도 진주시 판문동 290',
 '부산광역시 부산광역시진구 양정동 445-386',
 '부산광역시 부산광역시진구 양정동 25-3',
 '경상북도 진주시 문산읍 소문리 225',
 '경상북도 진주시 주약동 산 48-1',
 '부산광역시 부산광역시진구 연지동 238-4',
 '경상북도 진주시 상평동 283-1',
 '부산광역시 부산광역시진구 초읍동 54-74',
 '경상북도 진주시 가좌동 691',
 '경상북도 창원시 진해구 경화동 781-22',
 '경상북도 하동군 악양면 정서리 285-2',
 '경상북도 진주시 평거동 644-1',
 '부산광역시 부산광역시진구 당감동 271',
 '부산광역시 부산광역시진구 범전동 229-1',
 '부산광역시 부산광역시진구 당감동 899',
 '경상북도 진주시 평거동 466-1',
 '경상북도 진주시 문산읍 삼곡리 640-1',
 '경상북도 창원시 진해구 이동 468-3',
 '부산광역시 부산광역시진구 개금동 445-1',
 '경상북도 창원시 진해구 경화동 1186',
 '경상북도 진주시 문산읍 삼곡리 1033-1',
 '경상북도 창원시 마산합포구 가포동 418',
 '부산광역시 부산광역시진구 부전동 417-4',
 '경상북도 창원시 진해구 자은동 396',
 '경상북도 창원시 진해구 도천동 12',
 '경상북도 진주시 가좌동 996-12',
 '부산광역시 부산광역시진구 전포동 445-1',
 '부산광역시 부산광역시진구 전포동 445-1',
 '경상북도 창원시 진해구 태백동 5',
 '부산광역시 부산광역시진구 부전동 450-1',
 '경상북도 창원시 진해구 자은동 863-1',
 '부산광역시 부산광역시진구 가야동 459-45',
 '경상북도 창원시 마산합포구 현동 490',
 '경상북도 창원시 진해구 제황산동 28-13',
 '경상북도 창원시 진해구 이동 666',
 '경상북도 창원시 진해구 제황산동 28-2',
 '경상북도 창원시 진해구 도만동 1',
 '경상북도 창원시 진해구 풍호동 51-6',
 '경상북도 창원시 진해구 풍호동 83-107',
 '경상북도 창원시 진해구 장천동 119-35',
 '경상북도 창원시 진해구 마천동 144-8',
 '경상북도 창원시 마산합포구 진동면 진동리 113-1',
 '경상북도 창원시 마산합포구 진동면 진동리 533-5',
 '경상북도 진주시 정촌면 예하리 756-1',
 '경상북도 고성군 영오면 영산리 250',
 '경상북도 창원시 마산합포구 진전면 곡안리 77-1',
 '경상북도 하동군 횡천면 횡천리 752',
 '경상북도 창원시 진해구 두동 1166-4',
 '경상북도 창원시 진해구 성내동 399-4',
 '경상북도 창원시 마산합포구 진북면 지산리 61',
 '경상북도 창원시 진해구 남양동 203-1',
 '경상북도 하동군 북천면 직전리 667-1',
 '경상북도 창원시 진해구 명동 338',
 '경상북도 창원시 진해구 용원동 1251',
 '경상북도 창원시 진해구 안골동 372',
 '경상북도 고성군 개천면 명성리 632',
 '경상북도 창원시 진해구 안골동 369',
 '경상북도 창원시 진해구 청안동 475',
 '경상북도 창원시 마산합포구 진전면 오서리 892',
 '경상북도 고성군 영오면 영대리 519',
 '경상북도 창원시 진해구 청안동 480',
 '경상북도 사천시 사천읍 선인리 167-1',
 '경상북도 창원시 진해구 수도동 37',
 '경상북도 하동군 적량면 관리 136-2',
 '경상북도 창원시 마산합포구 구산면 반동리 383',
 '경상북도 고성군 구만면 효락리 621-2',
 '경상북도 사천시 사천읍 정의리 7',
 '경상북도 사천시 사남면 방지리 652',
 '경상북도 고성군 회화면 배둔리 347-10',
 '경상북도 하동군 하동읍 광평리 299',
 '경상북도 사천시 정동면 화암리 857-2',
 '경상북도 하동군 진교면 진교리 560-1',
 '경상북도 하동군 양보면 운암리 251',
 '경상북도 고성군 동해면 양촌리 174-1',
 '경상북도 고성군 동해면 양촌리 832',
 '경상북도 고성군 영현면 봉림리 44-9',
 '경상북도 고성군 영현면 침점리 350',
 '경상북도 고성군 회화면 배둔리 1182',
 '경상북도 고성군 마암면 도전리 492',
 '경상북도 고성군 회화면 배둔리 1112-1',
 '경상북도 고성군 거류면 감서리 2',
 '경상북도 고성군 대가면 유흥리 679',
 '경상북도 하동군 고전면 범아리 214-4',
 '경상북도 하동군 고전면 범아리 318',
 '경상북도 하동군 고전면 범아리 417',
 '경상북도 고성군 고성읍 기월리 83-9',
 '경상북도 고성군 거류면 신용리 888',
 '경상북도 고성군 고성읍 기월리 143-6',
 '경상북도 고성군 고성읍 기월리 143-1',
 '경상북도 하동군 금남면 덕천리 1243-1',
 '경상북도 고성군 거류면 당동리 235',
 '경상북도 고성군 고성읍 죽계리 735-1',
 '경상북도 고성군 거류면 당동리 66',
 '경상북도 고성군 상리면 척번정리 390',
 '경상북도 고성군 상리면 척번정리 424-1',
 '경상북도 사천시 송포동 176-1',
 '경상북도 고성군 고성읍 수남리 524',
 '경상북도 고성군 거류면 용산리 195-158',
 '경상북도 고성군 고성읍 성내리 2-9',
 '경상북도 고성군 고성읍 교사리 53',
 '경상북도 고성군 고성읍 서외리 90',
 '경상북도 고성군 고성읍 교사리 338-5',
 '경상북도 고성군 고성읍 교사리 956-4',
 '경상북도 고성군 고성읍 교사리 337-1',
 '경상북도 고성군 고성읍 송학리 309-1',
 '경상북도 거제시 사등면 창호리 761',
 '경상북도 고성군 고성읍 월평리 953',
 '경상북도 거제시 장목면 외포리 215',
 '경상북도 사천시 봉남동 479',
 '경상북도 고성군 하일면 학림리 701-2',
 '경상북도 고성군 하일면 학림리 722-5',
 '경상북도 남해군 설천면 남양리 71',
 '경상북도 고성군 하이면 덕호리 528-1',
 '경상북도 사천시 선구동 112',
 '경상북도 남해군 설천면 덕신리 1259-1',
 '경상북도 사천시 선구동 252',
 '경상북도 고성군 삼산면 미룡리 276',
 '경상북도 고성군 삼산면 미룡리 285',
 '경상북도 거제시 사등면 사등리 887',
 '경상북도 거제시 옥포동 1272-3',
 '경상북도 거제시 덕포동 542',
 '경상북도 거제시 연초면 죽토리 1131',
 '경상북도 거제시 사등면 성포리 606',
 '경상북도 거제시 연초면 죽토리 724',
 '경상북도 거제시 연초면 송정리 541',
 '경상북도 거제시 사등면 성포리 41-1',
 '경상북도 거제시 연초면 오비리 657-1',
 '경상북도 남해군 고현면 도마리 119-1',
 '경상북도 거제시 장승포동 319',
 '경상북도 거제시 장승포동 402',
 '경상북도 거제시 장승포동 402',
 '경상북도 거제시 능포동 459-2',
 '경상북도 거제시 고현동 293-3',
 '경상북도 거제시 사등면 덕호리 14-1',
 '경상북도 거제시 고현동 931-34',
 '경상북도 거제시 옥포동 539-1',
 '경상북도 거제시 장평동 348',
 '경상북도 거제시 옥포동 919',
 '경상북도 통영시 미수동 913-22',
 '경상북도 남해군 삼동면 지족리 255',
 '경상북도 거제시 둔덕면 술역리 808-1',
 '경상북도 거제시 거제면 법동리 566',
 '경상북도 남해군 남해읍 서변리 212',
 '경상북도 남해군 남해읍 남변리 195',
 '경상북도 남해군 남해읍 북변리 141-3',
 '경상북도 거제시 둔덕면 술역리 산 89-1',
 '경상북도 거제시 둔덕면 하둔리 407-2',
 '경상북도 남해군 남해읍 북변리 461-3',
 '경상북도 거제시 거제면 동상리 415',
 '경상북도 통영시 북신동 77-2',
 '경상북도 거제시 거제면 서정리 540',
 '경상북도 남해군 창선면 상죽리 265',
 '경상북도 거제시 장승포동 613',
 '경상북도 남해군 이동면 석평리 52-5',
 '경상북도 남해군 삼동면 동천리 1204-2',
 '경상북도 남해군 서면 서상리 655-1',
 '경상북도 거제시 동부면 산양리 296-6',
 '경상북도 거제시 일운면 지세포리 980',
 '경상북도 거제시 일운면 지세포리 745-1',
 '경상북도 남해군 남면 당항리 1410',
 '경상북도 거제시 동부면 율포리 628-1',
 '경상북도 통영시 한산면 창좌리 726-1',
 '경상북도 남해군 남면 당항리 1329-2',
 '경상북도 남해군 미조면 미조리 465',
 '경상북도 거제시 남부면 저구리 311',
 '경상북도 사천시 벌리동 2',
 '경상북도 통영시 욕지면 동항리 833-1',
 '제주특별자치도 제주시 오라1동 1140-3',
 '제주특별자치도 제주시 이도1동 1700-1',
 '제주특별자치도 제주시 일도2동 162-46',
 '제주특별자치도 제주시 용담1동 382-10',
 '제주특별자치도 제주시 화북1동 4675']
"""
# 세션 연결
engine = create_engine('sqlite:///check_safezone.sqlite')
Session = sessionmaker(bind=engine)
session = Session()

data = session.query(POI).filter(POI.bjdAd != "").all()

count1 = 0
count2 = 0
fail = []

with progressbar.ProgressBar(max_value=len(data)) as bar:
    for x in data:
        count1 += 1
        # print(x.address)
        CD = find_cd(x.bjdAd)
        if CD:
            count2 += 1
            # print('test 결과',CD)
        else:
            fail.append(x.bjdAd)
        bar.update(count1)



print("총 {0}개의 주소에서 {1}개가 성공적으로 변환됬으며 {2}개는 실패함".format(count1,count2,count1-count2))
print("법정코드 변환 실패한 주소입니다.")
print("===============================")
pprint(fail)

